<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¬Ø³ØªØ¬ÙˆÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ø¢ÛŒØ¯ÛŒ</title>

<link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />

<style>
  :root { --primary-color: #3d8bff; --success-color: #28a745; --error-color: #e74c3c; --light-bg: #f4f7fc; --dark-text: #333; --border-radius: 12px; --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
  * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Vazirmatn', sans-serif; }
  body { background-color: var(--light-bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; flex-direction: column; padding: 20px; color: var(--dark-text); }
  h2 { font-size: 1.6rem; color: var(--dark-text); margin-bottom: 20px; text-align: center; }

  .manual-input-container {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    width: 100%;
    max-width: 400px;
  }
  #manual-barcode-input {
    flex-grow: 1;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 1rem;
    text-align: left;
    direction: ltr;
  }
  #manual-submit-btn {
    padding: 12px 20px;
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: bold;
    transition: background-color 0.2s;
  }
  #manual-submit-btn:hover { background-color: #3377dd; }

  .result-card { width: 100%; max-width: 500px; background-color: #fff; border-radius: 8px; padding: 20px; box-shadow: var(--box-shadow); min-height: 150px; display: flex; flex-direction: column; transition: all 0.3s ease; text-align: right; }
  .result-card .message { font-size: 1.2rem; color: #444; }
  .result-card.found { border-top: 5px solid var(--primary-color); }
  .result-card.not-found { border-top: 5px solid var(--error-color); background-color: #fff3f3; }
  
  .user-info h3 { font-size: 1.6rem; color: var(--primary-color); margin-bottom: 15px; text-align: center; }
  .user-info ul { list-style: none; padding: 0; width: 100%; }
  .user-info li { padding: 8px; margin: 5px 0; background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; }
  .user-info li b { color: var(--primary-color); margin-left: 8px; }

  /* Ù†Ø§Ù‡Ø§Ø± Ø¨Ø§Ù„Ø§ */
  .lunch-status {
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: bold;
    font-size: 1.2rem;
    margin-bottom: 15px;
    text-align: center;
  }
  .lunch-ok { background-color: var(--success-color); color: #fff; }
  .lunch-no { background-color: var(--error-color); color: #fff; }
</style>
</head>
<body>

<h2>Ø¢ÛŒØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</h2>

<div class="manual-input-container">
    <input type="number" id="manual-barcode-input" placeholder="Ù…Ø«Ù„Ø§Ù‹ 23">
    <button id="manual-submit-btn">Ø¨Ø±Ø±Ø³ÛŒ</button>
</div>

<div id="result" class="result-card">
    <div class="message">Ù„Ø·ÙØ§Ù‹ Ø¢ÛŒØ¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const resultCard = document.getElementById('result');
        const manualInput = document.getElementById('manual-barcode-input');
        const manualSubmitBtn = document.getElementById('manual-submit-btn');

        const baseUrl = "https://raw.githubusercontent.com/sarvari1378/QRCode_Resolver/main/Data";

        function displayMessage(text, type = 'info') {
            resultCard.innerHTML = `<div class="message">${text}</div>`;
            resultCard.classList.remove('found', 'not-found');
            if (type === 'error') resultCard.classList.add('not-found');
        }

        function displayUserInfo(user) {
            if (!user) { displayMessage("Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.", "error"); return; }
            resultCard.classList.remove('not-found'); 
            resultCard.classList.add('found');

            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù†Ø§Ù‡Ø§Ø±
            let lunchHtml = "";
            if (user["Ù†Ø§Ù‡Ø§Ø±"]) {
                lunchHtml = `<div class="lunch-status lunch-ok">ğŸ½ï¸ Ù†Ø§Ù‡Ø§Ø±: ${user["Ù†Ø§Ù‡Ø§Ø±"]}</div>`;
            } else {
                lunchHtml = `<div class="lunch-status lunch-no">âŒ Ù†Ø§Ù‡Ø§Ø± Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</div>`;
            }

            let html = `<div class="user-info">${lunchHtml}<h3>${user.Name || "Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù…"}</h3><ul>`;
            for (const [key, value] of Object.entries(user)) {
                if (['id', 'Name', 'Ù†Ø§Ù‡Ø§Ø±'].includes(key)) continue; // Ù†Ø§Ù‡Ø§Ø± Ø±Ùˆ Ø¯ÛŒÚ¯Ù‡ ØªÙˆ Ù„ÛŒØ³Øª Ù†Ø´ÙˆÙ† Ù†Ø¯ÛŒÙ…
                html += `<li><b>${key}:</b> ${value || "Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡"}</li>`;
            }
            html += "</ul></div>";
            resultCard.innerHTML = html;
        }

        async function fetchUserById(id) {
            try {
                const res = await fetch(`${baseUrl}/${id}.json`);
                if (!res.ok) throw new Error("Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.");
                const data = await res.json();
                displayUserInfo(data);
            } catch (e) {
                displayMessage(e.message, "error");
            }
        }

        function handleSubmit() {
            const id = manualInput.value.trim();
            if (!id) { displayMessage("Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ø¯Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.", "error"); return; }
            fetchUserById(id);
            manualInput.value = '';
            manualInput.focus();
        }

        manualSubmitBtn.addEventListener('click', handleSubmit);
        manualInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') handleSubmit(); });
    });
</script>

</body>
</html>
